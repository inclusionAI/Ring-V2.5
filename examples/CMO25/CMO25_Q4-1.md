**1. Notation and basic definitions**

Number the positions of the pile from top (position 1) to bottom (position 70). The **top 50** are positions $1,\dots,50$; the **bottom 20** are positions $51,\dots,70$.

For each colour $c$ let  
$$
t_c = \text{number of cards of colour }c\text{ that lie in the top 50}.
$$

The set of colours that actually appear somewhere in the deck is fixed (cards are only moved, never added or removed); denote it by $\mathcal{C}$.  
Define  

$$
M = \bigl|\{\,c\in\mathcal{C} \mid t_c = 0\,\}\bigr|.
$$

Thus $M$ counts the colours that are present in the deck but are absent from the top 50.  
An operation can be performed exactly when $M>0$ (we need a colour with $t_c=0$ to choose the card $X$).

Next, define  

$$
K = \max\Bigl\{\,k\ge 0 \;\Big|\; \text{for every } i=0,\dots,k-1,\; 
\text{the card at position }50-i\text{ has }t_{\text{colour}} = 1\Bigr\}.
$$

In words, $K$ is the length of the longest suffix of the top 50 consisting entirely of cards whose colours appear **exactly once** in the top 50. (If the card at position 50 does not have $t=1$, then $K=0$.)  
Because there are at most 30 different colours, at most 30 cards in the top 50 can have $t_c=1$; all cards in the suffix have distinct colours, so $K\le 30$.

**2. Existence of a suitable $Y$ when $M>0$**

Whenever $M>0$, there is at least one colour missing from the top 50. Consequently, the number of distinct colours appearing in the top 50 is at most $29$. With 50 cards and at most 29 colours, the pigeonhole principle guarantees that some colour appears at least twice. Hence a card $Y$ with $t_{\text{colour}(Y)}\ge 2$ always exists. Therefore, as long as $M>0$ the operation can be carried out.

**3. Effect of one operation**

Consider any legal operation.  

- Choose $X$ from the bottom 20; its colour $x$ satisfies $t_x=0$ (so $x\in\mathcal{C}$ and $x$ contributes to $M$).  
- Choose $Y$ from the top 50; its colour $y$ satisfies $t_y\ge 2$.  
- Let $Z$ be the card originally at position 50, and denote its colour by $z$ and its multiplicity before the operation by $a = t_z\;(a\ge 1)$.

The operation removes $X$ and inserts it immediately above $Y$. The only change to the composition of the top 50 is that $X$ enters and $Z$ leaves. Thus the new multiplicities are  

$$
t_x' = 1,\qquad t_z' = a-1,
$$

while $t_c' = t_c$ for all other colours $c$.

We now examine how $M$ and $K$ change.

**Change of $M$**  

- Colour $x$: before, $t_x=0$ and $x\in\mathcal{C}$, so $x$ contributed to $M$; after, $t_x'=1$, so $x$ leaves $M$.  
- Colour $z$: before, $t_z=a$; after, $t_z'=a-1$.  
  * If $a\ge 2$: then $t_z'\ge 1$, so $z$ remains present in the top 50 and therefore does **not** belong to $M$ (since $M$ requires $t_c=0$).  
  * If $a=1$: then $t_z'=0$ and $z$ is still in the deck (it moved to the bottom), so $z$ **enters** $M$.

Consequently:  

- If $a\ge 2$: one colour ($x$) leaves $M$ and no new colour enters → $M$ **decreases by 1**.  
- If $a=1$: $x$ leaves $M$ and $z$ enters $M$ → $M$ **stays the same**.

**Change of $K$**  

We distinguish the two cases.

*Case 1: $a\ge 2$.*  
Before the operation, the card at position 50 (colour $z$) has $t_z\ge2$, hence it is **not** unique. By definition of $K$, this forces $K=0$ (a suffix of length 1 would already contain a non‑unique card). After the operation, $K'$ may be any value between $0$ and $30$, but since $M$ has strictly decreased, the pair $(M,K)$ decreases lexicographically regardless of $K'$.

*Case 2: $a=1$.*  
Now $t_z=1$, so $Z$ is a unique card. Therefore $K\ge 1$ (at least position 50 belongs to the suffix). Let $K$ be the suffix length **before** the operation. All cards in that suffix have $t=1$. The chosen card $Y$ has $t_y\ge2$, so $Y$ cannot lie inside the suffix; hence the position $i$ of $Y$ satisfies  

$$
i \le 50 - K. \tag{1}
$$

We now construct the new top 50 after the operation.  
- Cards at positions $1,\dots,i-1$ stay in place.  
- Position $i$ is occupied by the new card $X$.  
- For positions $i+1,\dots,50$ we take the cards originally at positions $i,\dots,49$ (shifted one place to the right).  
- The original card $Z$ (position 50) is gone.

We determine the new suffix of unique cards.

The old suffix consisted of positions $50-K+1,\,50-K+2,\,\dots,\,50$. Because $i\le 50-K$ by (1), all positions $\ge 50-K+1$ are $> i$. Therefore the cards originally at positions $50-K+1,\dots,49$ move to positions $(50-K+2),\dots,50$, respectively. Their colours are unchanged and remain unique (they are neither $x$ nor $z$).  

Position $50-K+1$ after the operation is occupied by the card originally at position $50-K$. By maximality of $K$, that card is **not** unique, and its colour’s multiplicity does not change (it is neither $x$ nor $z$), so it stays non‑unique.  

The newly inserted card $X$ (now unique) sits at position $i\le 50-K$, which is strictly above position $50-K+1$; thus $X$ is not part of the suffix.

Consequently, after the operation the longest suffix of unique cards consists exactly of positions $(50-K+2)$ to $50$, and its length is  

$$
K' = 50 - (50-K+2) + 1 = K-1.
$$

Hence in this case $K$ **decreases by 1** while $M$ stays unchanged.

**4. Lexicographic decrease of $(M,K)$**  

In both cases we have shown:  

- If $a\ge 2$: $M' = M-1$ (so $(M',K') < (M,K)$ lexicographically).  
- If $a=1$: $M' = M$ and $K' = K-1$ (so again $(M',K') < (M,K)$ lexicographically).

Therefore **every legal operation strictly decreases the ordered pair $(M,K)$ in the lexicographic order**.

**5. Termination**  

The values of $M$ and $K$ are non‑negative integers bounded by $30$ (since there are only 30 colours). Thus the set of possible pairs $(M,K)$ is finite. A strictly decreasing sequence in a finite set cannot be infinite. Hence the number of operations is finite, i.e., the process must eventually reach a state where no card $X$ satisfying the condition exists (equivalently, $M=0$) and then stop.

This holds for **any** initial selection of 70 cards and **any** admissible choices of $X$ and $Y$ during the operations. The proof is complete. ∎